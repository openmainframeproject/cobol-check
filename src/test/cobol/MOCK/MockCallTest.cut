      * Test for mocking call statements

            TestSuite "validate call mocking"
           TestCase "parameters with IN are recognized correctly"
           MOVE SPACES TO OUTPUT-VALUE
           MOCK CALL 'MYCOBOL' USING ACTION-PARAM,
                                    BOOK-PARAM in COBOL-STRUCTURE,
                                    OUTPUT-VALUE.
                MOVE "MOCKED" TO OUTPUT-VALUE
           END-MOCK
           PERFORM 610-CALL-WITH-STRUCTURE
           EXPECT OUTPUT-VALUE TO BE "MOCKED"
           VERIFY CALL 'MYCOBOL' USING ACTION-PARAM,
                                       BOOK-PARAM in COBOL-STRUCTURE,
                                       OUTPUT-VALUE
                  HAPPENED ONCE
           
           TestCase "parameters with OF are recognized correctly"
           MOVE SPACES TO OUTPUT-VALUE
           MOCK CALL 'MYCOBOL' USING ACTION-PARAM,
                                    BOOK-PARAM OF COBOL-STRUCTURE,
                                    OUTPUT-VALUE.
                MOVE "MOCKED" TO OUTPUT-VALUE
           END-MOCK
           PERFORM 610-CALL-WITH-STRUCTURE
           EXPECT OUTPUT-VALUE TO BE "MOCKED"

           VERIFY CALL 'MYCOBOL' USING ACTION-PARAM,
                                       BOOK-PARAM in COBOL-STRUCTURE,
                                       OUTPUT-VALUE
                  HAPPENED ONCE
           .

           TestCase "handles correctly when some calls are not mocked (should fail)"
           PERFORM 600-MAKE-CALL
           EXPECT VALUE-1 TO BE "arg1"

           TestCase "handles correctly when some calls are not mocked and uses expect keyword (should fail)"
           MOCK CALL 'PROG2'
                  MOVE "arg1" TO VALUE-1
           END-MOCK
           PERFORM 600-MAKE-CALL
           VERIFY CALL 'PROG2' NEVER HAPPENED

           TestCase "handles correctly when any of the calls are not mocked (should fail)"
           MOCK CALL 'PROG3' USING VALUE-1
                  MOVE "arg3" TO VALUE-1
           END-MOCK
           PERFORM 800-MAKE-CALL
           EXPECT VALUE-1 TO BE "arg3"

           TestCase "handles mocked paragraph correctly"
           MOCK PARAGRAPH 600-MAKE-CALL
                  MOVE "MOCKED PARA" TO VALUE-1
           END-MOCK
           PERFORM 600-MAKE-CALL
           EXPECT VALUE-1 TO BE "MOCKED PARA"